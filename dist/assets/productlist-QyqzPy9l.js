import{r as n,j as e,C as D,L as l,u as K,a as z,T as W,b as X,S as Z,P as ee,D as se,c as ae}from"./index-BLF3I7OA.js";import{d as te}from"./download-img-BXqMJmuh.js";import{I as le}from"./image-lightbox-C5fTUAkg.js";const re=()=>{const[u,d]=n.useState(""),[S,P]=n.useState(null),m=[{value:"choose",label:"Choose"},{value:"boldV3.2",label:"Bold V3.2"},{value:"nikeJordan",label:"Nike Jordan"},{value:"iphone14Pro",label:"Iphone 14 Pro"}],y=[{value:"choose",label:"Choose"},{value:"laptop",label:"Laptop"},{value:"electronics",label:"Electronics"},{value:"shoe",label:"Shoe"}],$=[{value:"choose",label:"Choose"},{value:"lenovo",label:"Lenovo"},{value:"bolt",label:"Bolt"},{value:"nike",label:"Nike"}],[F,B]=n.useState(null);return e.jsx("div",{children:e.jsx("div",{className:"modal fade",id:"view-notes",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsx("div",{className:"modal-content",children:e.jsx("div",{className:"page-wrapper-new p-0",children:e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"modal-header border-0 custom-modal-header",children:[e.jsx("div",{className:"page-title",children:e.jsx("h4",{children:"Import Product"})}),e.jsx("button",{type:"button",className:"close","data-bs-dismiss":"modal","aria-label":"Close",children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]}),e.jsx("div",{className:"modal-body custom-modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-4 col-sm-6 col-12",children:e.jsxs("div",{className:"input-blocks",children:[e.jsx("label",{children:"Product"}),e.jsx(D,{className:"w-100",options:m,value:S,onChange:b=>P(b.value),placeholder:"Choose",filter:!1})]})}),e.jsx("div",{className:"col-lg-4 col-sm-6 col-12",children:e.jsxs("div",{className:"input-blocks",children:[e.jsx("label",{children:"Category"}),e.jsx(D,{className:"w-100",options:y,value:F,onChange:b=>B(b.value),placeholder:"Choose",filter:!1})]})}),e.jsx("div",{className:"col-lg-4 col-sm-6 col-12",children:e.jsxs("div",{className:"input-blocks",children:[e.jsx("label",{children:"Satus"}),e.jsx(D,{className:"w-100",options:$,value:u,onChange:b=>d(b.value),placeholder:"Choose",filter:!1})]})}),e.jsx("div",{className:"col-lg-12 col-sm-6 col-12",children:e.jsx("div",{className:"row",children:e.jsx("div",{children:e.jsx("div",{className:"modal-footer-btn download-file",children:e.jsx(l,{to:"#",className:"btn btn-submit",children:"Download Sample File"})})})})}),e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"input-blocks image-upload-down",children:[e.jsx("label",{children:" Upload CSV File"}),e.jsxs("div",{className:"image-upload download",children:[e.jsx("input",{type:"file"}),e.jsxs("div",{className:"image-uploads",children:[e.jsx("img",{src:te,alt:"img"}),e.jsxs("h4",{children:["Drag and drop a ",e.jsx("span",{children:"file to upload"})]})]})]})]})}),e.jsx("div",{className:"col-lg-12 col-sm-6 col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Created by"}),e.jsx("input",{type:"text",className:"form-control"})]})})]}),e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"mb-3 input-blocks",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",defaultValue:""}),e.jsx("p",{className:"mt-1",children:"Maximum 60 Characters"})]})}),e.jsx("div",{className:"col-lg-12",children:e.jsxs("div",{className:"modal-footer-btn",children:[e.jsx("button",{type:"button",className:"btn btn-cancel me-2","data-bs-dismiss":"modal",children:"Cancel"}),e.jsx(l,{to:"#",className:"btn btn-submit",children:"Submit"})]})})]})})]})})})})})})},ne=()=>{const[u,d]=n.useState(1),[S,P]=n.useState(0),[m,y]=n.useState(10),[$,F]=n.useState(void 0),[B,b]=n.useState([]),[O,R]=n.useState(!0),[T,L]=n.useState(null),[g,I]=n.useState({categories:[],brands:[],products:[],createdBy:[]}),[a,h]=n.useState({category:"",brand:"",product:"",createdby:""}),[c,p]=n.useState({field:"",order:""}),Q=()=>{h({category:"",brand:"",product:"",createdby:""}),p({field:"",order:""}),d(1)},N=s=>{h(o=>({...o,[s]:""})),d(1)},q=s=>{F(s)},f=K(),E=z();n.useEffect(()=>{const s=new URLSearchParams(f.search||""),o=parseInt(s.get("page")||"1",10)||1,r=parseInt(s.get("rows")||String(m),10)||m,x=s.get("category")||"",i=s.get("brand")||"",j=s.get("product")||"",U=s.get("createdby")||"",v=s.get("sortField")||"",t=s.get("sortOrder")||"";d(o),y(r),h({category:x,brand:i,product:j,createdby:U}),p({field:v,order:t})},[f.search]),n.useEffect(()=>{const s=new URLSearchParams;u&&u!==1&&s.set("page",String(u)),m&&m!==10&&s.set("rows",String(m)),a.category&&s.set("category",a.category),a.brand&&s.set("brand",a.brand),a.product&&s.set("product",a.product),a.createdby&&s.set("createdby",a.createdby),c.field&&s.set("sortField",c.field),c.order&&s.set("sortOrder",c.order);const o=s.toString(),r=(f.search||"").replace(/^\?/,"");if(o!==r){const x=o?`${f.pathname}?${o}`:`${f.pathname}`;E(x,{replace:!0})}},[u,m,a,c,E,f.pathname,f.search]);const M=X,Y=[{header:"ID",field:"id",key:"id",sortable:!0,className:"id-col"},{header:e.jsxs("label",{className:"checkboxs",children:[e.jsx("input",{type:"checkbox",id:"select-all"}),e.jsx("span",{className:"checkmarks"})]}),body:()=>e.jsxs("label",{className:"checkboxs",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{className:"checkmarks"})]}),sortable:!1,key:"checked"},{header:"SKU",field:"sku",key:"sku",sortable:!0},{header:"Product",field:"product",key:"product",sortable:!0,body:s=>e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(l,{to:"#",className:"avatar avatar-md me-2",onClick:o=>{o.preventDefault(),V(s.images||[s.productImage],0)},children:e.jsx("img",{alt:"",src:s.productImage})}),e.jsx(l,{to:`${M.productdetails}/${encodeURIComponent(s.id)}`,children:s.product})]})},{header:"Category",field:"category",key:"category",sortable:!0},{header:"Brand",field:"brand",key:"brand",sortable:!0},{header:"Price",field:"price",key:"price",sortable:!0},{header:"Unit",field:"unit",key:"unit",sortable:!0},{header:"Qty",field:"qty",key:"qty",sortable:!0},{header:"Created By",field:"createdby",key:"createdby",sortable:!0,body:s=>e.jsxs("span",{className:"userimgname",children:[e.jsx(l,{to:"/profile",className:"product-img",children:e.jsx("img",{alt:"",src:s.img})}),e.jsx(l,{to:"/profile",children:s.createdby})]})},{header:"",field:"actions",key:"actions",sortable:!1,body:s=>e.jsxs("div",{className:"edit-delete-action d-flex align-items-center",children:[e.jsx(l,{className:"me-2 p-2 d-flex align-items-center border rounded",to:"#","data-bs-toggle":"modal","data-bs-target":"#edit-customer",children:e.jsx("i",{className:"feather icon-edit"})}),e.jsx(l,{className:"p-2 d-flex align-items-center border rounded",to:"#","data-bs-toggle":"modal","data-bs-target":"#delete-modal",children:e.jsx("i",{className:"feather icon-trash-2"})})]})}],[A,w]=n.useState({open:!1,images:[],index:0}),V=(s=[],o=0)=>w({open:!0,images:s,index:o}),G=()=>w({open:!1,images:[],index:0});return n.useEffect(()=>{let s=!0;return(async()=>{R(!0);try{L(null);const r=new URLSearchParams({page:String(u),rows:String(m)});a.category&&r.set("category",a.category),a.brand&&r.set("brand",a.brand),a.product&&r.set("product",a.product),a.createdby&&r.set("createdby",a.createdby),c.field&&r.set("sortField",c.field),c.order&&r.set("sortOrder",c.order);const x=`/api/Product?${r.toString()}`;let i;try{i=await fetch(x)}catch(t){console.warn("Relative fetch failed, trying direct backend",t),i=await fetch(`http://localhost:3000/api/Product?${r.toString()}`)}if(!i.ok&&i.status>=400)try{const t=await fetch(`http://localhost:3000/api/Product?${r.toString()}`);t.ok&&(i=t)}catch{}if(!i.ok){const t=await i.text().catch(()=>""),k=`GET ${i.url} -> ${i.status} ${i.statusText} ${t?`
Response: `+t.slice(0,1e3):""}`;console.error(k),L(k),s&&b([]);return}const j=await i.json(),v=(Array.isArray(j)?j:j.data||[]).map((t,k)=>{const H=t["Hình ảnh"]||t.Image||t.images||"";let C=[];H&&(C=String(H).split(",").map(J=>J.trim()).filter(Boolean));const _=C.length?C[0]:"";return{id:t.ID||t.id||(j.page-1)*j.rows+k+1,sku:t.SKU||t.Sku||"",product:t.Tên||t.Name||t.name||"",productImage:_,images:C,category:t["Danh mục"]||t["Danh muc"]||t.Category||"",brand:t["Thương hiệu"]||t.Brand||"",price:t["Giá thông thường"]||t.Price||"",unit:t["Giá trị thuộc tính 1"]||t["Tên thuộc tính 1"]||t["attribute 1"]||"",qty:t["Tồn kho"]||t.Stock||"",createdby:"",img:ae}});s&&(b(v),P(j.total||v.length))}catch(r){console.error("Fetch products error",r),L(String(r))}finally{s&&R(!1)}})(),()=>{s=!1}},[u,m,a,c]),n.useEffect(()=>{let s=!0;return(async()=>{try{let r;try{r=await fetch("/api/Product/meta")}catch(x){console.warn("Relative meta fetch failed, trying backend directly",x);try{r=await fetch("http://localhost:3000/api/Product/meta")}catch{r=null}}if(r&&r.ok){const x=await r.json();s&&I(x)}else console.warn("Meta endpoint not available; continuing without meta dropdowns"),s&&I({categories:[],brands:[],products:[],createdBy:[]})}catch(r){console.warn("Fetch meta error (ignored)",r),s&&I({categories:[],brands:[],products:[],createdBy:[]})}})(),()=>{s=!1}},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"page-wrapper",children:e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"add-item d-flex",children:[e.jsxs("div",{className:"page-title",children:[e.jsx("h4",{children:"Product List"}),e.jsx("h6",{children:"Manage your products"})]}),(a.category||a.brand||a.product||a.createdby||c.field)&&e.jsxs("div",{className:"w-100 mt-2 d-flex align-items-center flex-wrap gap-2",children:[e.jsxs("div",{className:"filter-badges d-flex align-items-center flex-wrap",children:[a.product?e.jsxs("span",{className:"badge bg-secondary me-2",children:["Product: ",a.product," ",e.jsx("button",{type:"button",className:"btn-close btn-close-white btn-sm ms-2","aria-label":"Clear",onClick:()=>N("product")})]}):null,a.category?e.jsxs("span",{className:"badge bg-secondary me-2",children:["Category: ",a.category," ",e.jsx("button",{type:"button",className:"btn-close btn-close-white btn-sm ms-2","aria-label":"Clear",onClick:()=>N("category")})]}):null,a.brand?e.jsxs("span",{className:"badge bg-secondary me-2",children:["Brand: ",a.brand," ",e.jsx("button",{type:"button",className:"btn-close btn-close-white btn-sm ms-2","aria-label":"Clear",onClick:()=>N("brand")})]}):null,a.createdby?e.jsxs("span",{className:"badge bg-secondary me-2",children:["Created By: ",a.createdby," ",e.jsx("button",{type:"button",className:"btn-close btn-close-white btn-sm ms-2","aria-label":"Clear",onClick:()=>N("createdby")})]}):null,c.field?e.jsxs("span",{className:"badge bg-info text-dark me-2",children:["Sort: ",c.field," ",c.order," ",e.jsx("button",{type:"button",className:"btn-close btn-close-white btn-sm ms-2","aria-label":"Clear",onClick:()=>p({field:"",order:""})})]}):null]}),e.jsx("div",{className:"ms-auto",children:e.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:Q,children:"Clear All Filters"})})]})]}),e.jsx(W,{}),e.jsx("div",{className:"page-btn",children:e.jsxs(l,{to:M.addproduct,className:"btn btn-primary",children:[e.jsx("i",{className:"ti ti-circle-plus me-1"}),"Add New Product"]})}),e.jsx("div",{className:"page-btn import",children:e.jsxs(l,{to:"#",className:"btn btn-secondary color","data-bs-toggle":"modal","data-bs-target":"#view-notes",children:[e.jsx("i",{className:"feather icon-download feather me-2"}),"Import Product"]})})]}),e.jsxs("div",{className:"card table-list-card",children:[e.jsxs("div",{className:"card-header d-flex align-items-center justify-content-between flex-wrap row-gap-3",children:[e.jsx(Z,{callback:q,rows:m,setRows:y}),e.jsxs("div",{className:"d-flex table-dropdown my-xl-auto right-content align-items-center flex-wrap row-gap-3",children:[e.jsxs("div",{className:"dropdown me-2",children:[e.jsx(l,{to:"#",className:"dropdown-toggle btn btn-white btn-md d-inline-flex align-items-center","data-bs-toggle":"dropdown",children:a.product||"Product"}),e.jsxs("ul",{className:"dropdown-menu  dropdown-menu-end p-3",style:{maxHeight:"280px",overflowY:"auto"},children:[e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(s=>({...s,product:""})),d(1)},children:"All Products"})}),g.products&&g.products.map(s=>e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(o=>({...o,product:s})),d(1)},children:s})},s))]})]}),e.jsxs("div",{className:"dropdown me-2",children:[e.jsx(l,{to:"#",className:"dropdown-toggle btn btn-white btn-md d-inline-flex align-items-center","data-bs-toggle":"dropdown",children:a.createdby||"Created By"}),e.jsxs("ul",{className:"dropdown-menu  dropdown-menu-end p-3",style:{maxHeight:"280px",overflowY:"auto"},children:[e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(s=>({...s,createdby:""})),d(1)},children:"All"})}),g.createdBy&&g.createdBy.map(s=>e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(o=>({...o,createdby:s})),d(1)},children:s})},s))]})]}),e.jsxs("div",{className:"dropdown me-2",children:[e.jsx(l,{to:"#",className:"dropdown-toggle btn btn-white btn-md d-inline-flex align-items-center","data-bs-toggle":"dropdown",children:a.category||"Category"}),e.jsxs("ul",{className:"dropdown-menu  dropdown-menu-end p-3",style:{maxHeight:"280px",overflowY:"auto"},children:[e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(s=>({...s,category:""})),d(1)},children:"All Categories"})}),g.categories&&g.categories.map(s=>e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(o=>({...o,category:s})),d(1)},children:s})},s))]})]}),e.jsxs("div",{className:"dropdown me-2",children:[e.jsx(l,{to:"#",className:"dropdown-toggle btn btn-white btn-md d-inline-flex align-items-center","data-bs-toggle":"dropdown",children:a.brand||"Brand"}),e.jsxs("ul",{className:"dropdown-menu  dropdown-menu-end p-3",style:{maxHeight:"280px",overflowY:"auto"},children:[e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(s=>({...s,brand:""})),d(1)},children:"All Brands"})}),g.brands&&g.brands.map(s=>e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{h(o=>({...o,brand:s})),d(1)},children:s})},s))]})]}),e.jsxs("div",{className:"dropdown",children:[e.jsx(l,{to:"#",className:"dropdown-toggle btn btn-white btn-md d-inline-flex align-items-center","data-bs-toggle":"dropdown",children:c.field?`${c.field} ${c.order}`:"Sort By : Last 7 Days"}),e.jsxs("ul",{className:"dropdown-menu  dropdown-menu-end p-3",style:{maxHeight:"280px",overflowY:"auto"},children:[e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{p({field:"id",order:"desc"}),d(1)},children:"Recently Added"})}),e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{p({field:"product",order:"asc"}),d(1)},children:"Ascending"})}),e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{p({field:"product",order:"desc"}),d(1)},children:"Desending"})}),e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{p({field:"id",order:"asc"}),d(1)},children:"Oldest"})}),e.jsx("li",{children:e.jsx(l,{to:"#",className:"dropdown-item rounded-1",onClick:()=>{p({field:"",order:""}),d(1)},children:"Clear Sort"})})]})]})]}),T&&e.jsx("div",{className:"w-100 mt-2",children:e.jsxs("div",{className:"alert alert-danger",role:"alert",children:[e.jsx("strong",{children:"Data load error:"}),e.jsx("pre",{style:{whiteSpace:"pre-wrap",marginTop:6},children:T})]})})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"table-responsive",children:e.jsx(ee,{column:Y,data:B,rows:m,setRows:y,currentPage:u,setCurrentPage:d,totalRecords:S,loading:O,serverSide:!0,sortField:c.field||void 0,sortOrder:c.order==="desc"?-1:c.order==="asc"?1:void 0,onSort:s=>{const o=s.sortField,r=s.sortOrder===-1?"desc":"asc";p({field:o,order:r}),d(1)}})})})]}),e.jsx(re,{})]})}),e.jsx(le,{open:A.open,images:A.images,index:A.index,onClose:()=>G(),onPrev:()=>w(s=>({...s,index:Math.max(0,s.index-1)})),onNext:()=>w(s=>({...s,index:Math.min((s.images||[]).length-1,s.index+1)}))}),e.jsx(se,{})]})};export{ne as default};
