import{ci as M,u as k,r as h,j as e}from"./index-BLF3I7OA.js";import{I as B}from"./image-lightbox-C5fTUAkg.js";const R="http://localhost:3000";async function w(n,a){try{return await fetch(n,a)}catch(c){throw c}}async function U(n){if(!n)return null;const a=`/api/Product/${encodeURIComponent(n)}`;let c;try{c=await w(a)}catch{c=await w(`${R}/api/Product/${encodeURIComponent(n)}`)}if(!c.ok){if(c.status===404)return null;const m=await c.text().catch(()=>""),o=new Error(`Fetch product by id failed: ${c.status} ${c.statusText} ${m}`);throw o.response=c,o}const i=await c.json();return i&&(i.data||i)?i.data||i:null}const I=n=>{if(!n&&n!==0)return"";try{return String(n).replace(/<[^>]*>/g,"").replace(/\r|\n|\t/g," ").replace(/\s+/g," ").trim()}catch{return String(n)}},D=n=>{if(!n)return"";const a=String(n).match(/\(([^)]*)\)/);return a?a[1].trim():""},Q=()=>{const{id:n}=M(),a=k(),c=new URLSearchParams(a.search||""),i=n||c.get("id"),[m,o]=h.useState(!0),[P,S]=h.useState(null),[g,N]=h.useState(0),[x,d]=h.useState({open:!1,index:0,images:[]});if(h.useEffect(()=>{let s=!0;return i&&(async()=>{o(!0);try{const l=await U(i);if(!s)return;S(l||{});const b=[],y=l&&(l["Hình ảnh"]||l.Image||l.images||l.Images||"");y&&b.push(...String(y).split(",").map(j=>j.trim()).filter(Boolean)),d(j=>({...j,images:b})),N(0)}catch{}finally{s&&o(!1)}})(),()=>{s=!1}},[i]),!i)return e.jsx("div",{className:"page-wrapper",children:e.jsx("div",{className:"content",children:e.jsx("div",{className:"alert alert-warning",children:"No product id provided."})})});const C=s=>N(s),L=(s=0)=>d(r=>({...r,open:!0,index:s})),t=P||{},p=t.Tên||t.Name||t.name||"",T=t["Thương hiệu"]||t.Brand||"",$=t["Danh mục"]||t["Danh muc"]||t.Category||"",v=t["Giá trị thuộc tính 1"]||t["Tên thuộc tính 1"]||t["attribute 1"]||"",E=t["Mô tả ngắn"]||t["Short description"]||t.short_description||"",F=t["Mô tả"]||t.Description||t.description||"",H=D(p)||D(t["Quy cách"]||""),u=x.images||[],f=u[g]||u[0]||t["Hình đại diện"]||t.productImage||"";return e.jsxs("div",{className:"page-wrapper",children:[e.jsxs("div",{className:"content",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{className:"page-title",children:[e.jsx("h4",{children:"Product Detail"}),e.jsx("h6",{children:"Product information"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:m?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-5",children:e.jsxs("div",{className:"product-gallery",children:[e.jsx("div",{className:"main-image mb-3",children:f?e.jsx("img",{src:f,alt:p,className:"img-fluid",style:{maxHeight:420,objectFit:"contain",width:"100%"},onClick:()=>L(g)}):e.jsx("div",{className:"placeholder bg-light",style:{height:420}})}),e.jsx("div",{className:"thumbnails d-flex gap-2",children:u.length?u.map((s,r)=>e.jsx("button",{type:"button",className:`thumb btn p-0 border ${r===g?"active":""}`,onClick:()=>C(r),style:{width:76,height:76},children:e.jsx("img",{src:s,alt:`thumb-${r}`,style:{width:"100%",height:"100%",objectFit:"cover"}})},r)):null})]})}),e.jsx("div",{className:"col-lg-7",children:e.jsxs("div",{className:"product-info",children:[e.jsx("h2",{style:{marginTop:0},children:p}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"text-muted",children:["ID: ",e.jsx("strong",{children:t.ID||t.id||"-"})]}),e.jsxs("div",{className:"text-muted",children:["Thương hiệu: ",e.jsx("strong",{children:T||"-"})]})]}),e.jsxs("div",{className:"mb-2",children:["Danh mục: ",e.jsx("strong",{children:$||"-"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-1 text-muted",children:"Phân loại sản phẩm"}),e.jsx("div",{children:v?e.jsx("div",{className:"btn-group",children:e.jsx("button",{className:"btn btn-outline-primary",children:v})}):e.jsx("span",{className:"text-muted",children:"-"})})]}),e.jsx("hr",{}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-4 text-muted",children:"Mô tả ngắn"}),e.jsx("div",{className:"col-8",children:I(E)||"-"})]}),e.jsxs("div",{className:"row mt-2",children:[e.jsx("div",{className:"col-4 text-muted",children:"Quy cách"}),e.jsx("div",{className:"col-8",children:H||"-"})]}),e.jsx("div",{className:"row mt-3",children:e.jsxs("div",{className:"col-12",children:[e.jsx("div",{className:"text-muted mb-2",children:"Mô tả"}),e.jsx("div",{children:I(F)||"-"})]})})]})})]})})})]}),e.jsx(B,{open:x.open,images:x.images,index:x.index,onClose:()=>d(s=>({...s,open:!1})),onPrev:()=>d(s=>({...s,index:Math.max(0,s.index-1)})),onNext:()=>d(s=>({...s,index:Math.min((s.images||[]).length-1,s.index+1)}))})]})};export{Q as default};
